(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(22),i=a.n(l),c=(a(93),a(10)),o=(a(94),a(95),a(62),a(96),a(34)),u=a(27),s=a(46),m=a(153),d=a(152),E=a(146),g=a(147),f=a(58),v=a.n(f),p=a(82),h=a(48),b=a(83),y=a.n(b),C=function(e,t){switch(t.type){case"FETCH_INIT":return Object(h.a)({},e,{isLoading:!0,isError:!1});case"FETCH_SUCCESS":return Object(h.a)({},e,{isLoading:!1,isError:!1,data:t.payload});case"FETCH_FAILURE":return Object(h.a)({},e,{isLoading:!1,isError:!0});default:throw new Error}},S=function(e,t){var a=Object(n.useState)(e),r=Object(c.a)(a,2),l=r[0],i=r[1],o=Object(n.useReducer)(C,{isLoading:!1,isError:!1,data:t}),u=Object(c.a)(o,2),s=u[0],m=u[1];return Object(n.useEffect)(function(){var e=!1;return function(){var t=Object(p.a)(v.a.mark(function t(){var a;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return m({type:"FETCH_INIT"}),t.prev=1,t.next=4,y()(l);case 4:a=t.sent,e||m({type:"FETCH_SUCCESS",payload:a.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e||m({type:"FETCH_FAILURE"});case 11:case"end":return t.stop()}},t,null,[[1,8]])}));return function(){return t.apply(this,arguments)}}()(),function(){e=!0}},[l]),[s,i]},w=a(144),k=a(145),O=a(151),L=function(e){var t=e.item,a=e.isLoading;return e.isError?r.a.createElement(w.a,{variant:"danger"},r.a.createElement("p",null,"Error downloading ",t)):a?r.a.createElement(w.a,{variant:"info"},r.a.createElement(k.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",null,"Downloading ",t,"...")):r.a.createElement(w.a,{variant:"success"},r.a.createElement("p",null,"Download ",t," complete"))},j=function(e){var t=e.contactsState,a=e.institutesState,n=e.definitiveState,l=e.intermagnetState,i=0;return i+=t.isLoading&&!t.isError?0:1,i+=a.isLoading&&!a.isError?0:1,i+=n.isLoading&&!n.isError?0:1,i+=l.isLoading&&!l.isError?0:1,r.a.createElement(O.a,{show:4!==i,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(O.a.Header,null,r.a.createElement(O.a.Title,{id:"contained-modal-title-vcenter"},"INTERMAGNET metadata")),r.a.createElement(O.a.Body,null,r.a.createElement(L,{item:"contacts",isLoading:t.isLoading,isError:t.isError}),r.a.createElement(L,{item:"list of institutes",isLoading:a.isLoading,isError:a.isError}),r.a.createElement(L,{item:"definitive information",isLoading:n.isLoading,isError:n.isError}),r.a.createElement(L,{item:"intermanget observatory details",isLoading:l.isLoading,isError:l.isError})))},A=a(148),H=a(154),I=a(157),x=a(156),F=r.a.createContext({}),z=a(155),N=a(149),T=r.a.createContext({}),G=r.a.createContext({}),_={aq:"Antarctica",ar:"Argentina",at:"Austria",au:"Australia",be:"Belgium",bg:"Bulgaria",br:"Brazil",ca:"Canada",cf:"Central African Republic",cl:"Chile",cn:"China",cz:"Czech Republic",de:"Germany",dk:"Denmark",dz:"Algeria",es:"Spain",et:"Ethiopia",fi:"Finland",fk:"Falkland Islands (Islas Malvinas)",fr:"France",gb:"United Kingdom",gf:"French Guiana",gl:"Greenland",gr:"Greece",gs:"South Georgia and the South Sandwich Islands",hr:"Croatia",hu:"Hungary",ie:"Republic of Ireland",in:"India",it:"Italy",jp:"Japan",kr:"Korea",kz:"Kazakhstan",lb:"Lebanon",mg:"Madagascar",mv:"Maldives",mx:"Mexico",na:"Namibia",no:"Norway",nz:"New Zealand",pe:"Peru",pf:"French Polynesia",pk:"Pakistan",pl:"Poland",ro:"Romania",rs:"Serbia",ru:"Russia",se:"Sweden",sh:"Saint Helena, Ascension and Tristan da Cunha, British Overseas Territories",sk:"Slovakia",sn:"Senegal",tf:"French Southern and Antarctic Lands",tr:"Turkey",tw:"Taiwan",ua:"Ukraine",us:"United States of America",vn:"Vietnam",ws:"Western Samoa",za:"South Africa"},M=function(e,t,a){return e.reduce(function(e,n){return n[t]===a?n:e},{})},P=function(e){var t=e.show,a=e.onHide,n=e.iaga;return r.a.createElement(F.Consumer,null,function(e){if(!e)return null;var l=M(e,"id",n);return r.a.createElement(O.a,{show:t,onHide:a,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(O.a.Header,{closeButton:!0},r.a.createElement(O.a.Title,{id:"contained-modal-title-vcenter"},l.name," (",l.iaga,")")),r.a.createElement(O.a.Body,null,r.a.createElement(B,{observatory:l})))})};P.defaultProps={show:!0,onHide:function(){}};var B=function(e){var t=Object.assign({institutes:[],contacts:[]},e.observatory);return t.instruments=t.instruments_ml?t.instruments_ml[0].lines:[],r.a.createElement(T.Consumer,null,function(e){return r.a.createElement(G.Consumer,null,function(a){return t.institutes=t.institutes.map(function(t){return M(e,"id",t)}),t.contacts=t.contacts.map(function(e){return e in a?a[e]:{}}),r.a.createElement(E.a,{fluid:!0},r.a.createElement(g.a,null,r.a.createElement(A.a,{sm:12},r.a.createElement(R,t))),r.a.createElement(g.a,null,r.a.createElement(A.a,{sm:12},r.a.createElement(U,t))))})})},R=function(e){var t=e.iaga,a=e.name,n=e.latitude,l=e.longitude,i=e.elevation,c=e.institutes,o=e.country,u=e.instruments,s=e.contacts,m=e.status,d=e.gin,E=c.map(function(e){return Object.values(e).length?r.a.createElement("li",{key:e.id},e.names[0].name," (",e.names[0].abbr,")"):null}),g=s.map(function(e,t){if(!Object.values(e).length)return null;var a=Object.assign({},e.addresses.reduce(function(e,t){return"en"===t.lang?t:e},e.addresses[0]));delete a.lang;var n=[];return e.emails&&(n=e.emails.map(function(e){var t="mailto:".concat(e);return r.a.createElement("li",{key:e},r.a.createElement("a",{href:t},e))})),r.a.createElement("tr",{key:t},r.a.createElement("th",null,"Contact"),r.a.createElement("td",null,r.a.createElement("dl",null,r.a.createElement("dt",null,"Name"),r.a.createElement("dd",null,e.name),r.a.createElement("dt",null,"Address"),r.a.createElement("dd",null,Object.values(a).map(function(e,t){return r.a.createElement("div",{key:t},e)})),n.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("dt",null,"Email"),r.a.createElement("dd",null,r.a.createElement("ul",null,n))),r.a.createElement("dt",null,"Telephone"),r.a.createElement("dd",null,e.tel),"fax"in e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("dt",null,"Fax"),r.a.createElement("dd",null,e.fax)))))}),f=l>180?l-360:l;return r.a.createElement(N.a,{size:"sm"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("td",null,a)),r.a.createElement("tr",null,r.a.createElement("th",null,"IAGA code"),r.a.createElement("td",null,t)),r.a.createElement("tr",null,r.a.createElement("th",null,"Country"),r.a.createElement("td",null,o in _?_[o]:o)),r.a.createElement("tr",null,r.a.createElement("th",null,"Coordinates"),r.a.createElement("td",null,Math.abs(n).toFixed(4),n>=0?"N":"S",", ",Math.abs(f).toFixed(4),f>=0?"E":"W")),r.a.createElement("tr",null,r.a.createElement("th",null,"Elevation (m)"),r.a.createElement("td",null,i)),r.a.createElement("tr",null,r.a.createElement("th",null,"Status"),r.a.createElement("td",null,m)),r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("abbr",{title:"Geomagnetic Information Node"},"GIN")),r.a.createElement("td",null,d)),E.length>0&&r.a.createElement("tr",null,r.a.createElement("th",null,"Institute(s)"),r.a.createElement("td",null,r.a.createElement("ul",null,E))),u.length>0&&r.a.createElement("tr",null,r.a.createElement("th",null,"Instrument(s)"),r.a.createElement("td",null,r.a.createElement("ul",null,u.map(function(e,t){return r.a.createElement("li",{key:t},e)})))),g))};R.defaultProps={institutes:[],instruments:[],contacts:[],gin:""};var U=function(e){var t=e.latitude,a=e.longitude,n=e.status,l=a>180?a-360:a,i=[t,l];return r.a.createElement(H.a,{center:i,zoom:14,style:{height:"400px",width:"100%"},ref:function(e){return e?setTimeout(function(){return e.leafletElement.invalidateSize(!0)},100):null}},r.a.createElement(x.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.a.createElement(z.a,{center:[t,l],color:"imo"===n?"red":"grey"}))},D=P,W=function(e){var t=e.latitude,a=e.longitude,l=e.status,i=e.iaga,o=Object(n.useState)(!1),u=Object(c.a)(o,2),s=u[0],m=u[1];return r.a.createElement(z.a,{center:[t,a>180?a-360:a],onClick:function(){return m(!0)},color:"imo"===l?"red":"grey"},r.a.createElement(D,{show:s,onHide:function(){return m(!1)},iaga:i}))},J=function(e){var t=e.observatories,a=e.center,n=e.zoom;return r.a.createElement(F.Consumer,null,function(e){var l=t.map(function(t){var a,n,l=(a="id",n=t,e.reduce(function(e,t){return t[a]===n?t:e},{}));return r.a.createElement(W,{key:l.id,latitude:l.latitude,longitude:l.longitude,status:l.status,iaga:l.iaga})});return r.a.createElement(H.a,{center:a,zoom:n},r.a.createElement(I.a,{position:"topright"},r.a.createElement(I.a.BaseLayer,{name:"Streets"},r.a.createElement(x.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})),r.a.createElement(I.a.BaseLayer,{checked:!0,name:"Satellite"},r.a.createElement(x.a,{attribution:"Tiles \xa9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}))),l)})};J.defaultProps={center:[0,0],zoom:2};var K=J,q=function(){return r.a.createElement(A.a,{sm:12},r.a.createElement(F.Consumer,null,function(e){var t=e?e.map(function(e){return e.id}):[];return r.a.createElement(K,{observatories:t})}))},V=a(44),X=a(150),Y=function(e){var t=e.observatories,a=Object(n.useState)(!1),l=Object(c.a)(a,2),i=l[0],o=l[1],u=Object(n.useState)(""),s=Object(c.a)(u,2),m=s[0],d=s[1],E=[],g=[],f=t||[];f.forEach(function(e){e.country=e.country in _?_[e.country]:e.country}),f.sort(function(e,t){return e.iaga>t.iaga?1:e.iaga<t.iaga?-1:0}),f.forEach(function(e){"gin"in e&&E.indexOf(e.gin)<0&&E.push(e.gin)}),f.forEach(function(e){"status"in e&&g.indexOf(e.status)<0&&g.push(e.status)});var v=[{Header:"IAGA code",id:"iaga",accessor:"iaga",filterMethod:function(e,t){return!t[e.id]||t[e.id].toLowerCase().includes(e.value.toLowerCase())}},{Header:"Name",accessor:"name",filterMethod:function(e,t){return!t[e.id]||t[e.id].toLowerCase().includes(e.value.toLowerCase())}},{Header:"Country",accessor:"country",filterMethod:function(e,t){return!t[e.id]||t[e.id].toLowerCase().includes(e.value.toLowerCase())}},{Header:"Latitude",accessor:"latitude"},{Header:"Longitude",accessor:"longitude"},{Header:"Status",accessor:"status",Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement("select",{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{key:"all",value:""},"All"),g.map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))}},{Header:"GIN",accessor:"gin",Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement("select",{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{key:"all",value:""},"All"),E.map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))}},{Header:"Details",accessor:"properties.id",filterable:!1,Cell:function(e){return r.a.createElement(X.a,{onClick:function(){return function(e){d(e.original.iaga),o(!0)}(e)}},"view")}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{data:f,className:"-striped -highlight",columns:v,filterable:!0,sortable:!0,resizable:!0,defaultSorting:[{id:"iaga",desc:!1}]}),r.a.createElement(D,{show:i,onHide:function(){return o(!1)},iaga:m}))},Z=function(){return r.a.createElement(A.a,{sm:12},r.a.createElement(F.Consumer,null,function(e){return r.a.createElement(Y,{observatories:e||[]})}))},$=r.a.createContext({}),Q=function(e){var t=e.definitives,a=e.setSelectedObservatories,l=Object(n.useState)(!1),i=Object(c.a)(l,2),o=i[0],u=i[1],s=Object(n.useState)(""),m=Object(c.a)(s,2),d=m[0],E=m[1],g=Object(n.useState)(""),f=Object(c.a)(g,2),v=f[0],p=f[1],h=[];(t||[]).forEach(function(e){var t=e.id;e.observatories.forEach(function(e){h.push({year:t,iaga:e.iaga_code,republish:"republish"in e?e.republish:""})})}),h.sort(function(e,t){return e.year>t.year?-1:e.iaga<t.iaga?1:0});var b={};h.forEach(function(e){e.year in b?b[e.year].push(e.iaga):b[e.year]=[]});var y=[{Header:"Year",accessor:"year",Filter:function(e){e.filter;var t=e.onChange;return r.a.createElement("select",{onChange:function(e){t(e.target.value),p(e.target.value),a(e.target.value in b?b[e.target.value]:[])},style:{width:"100%"},value:v},r.a.createElement("option",{value:""},"All"),Object.keys(b).reverse().map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))},Cell:function(e){return r.a.createElement("div",{style:{textAlign:"center"}},e.value)}},{Header:"Republish",accessor:"republish",Cell:function(e){return r.a.createElement("div",{style:{textAlign:"center"}},e.value)}},{Header:"IAGA code",accessor:"iaga",filterMethod:function(e,t){return!t[e.id]||t[e.id].toLowerCase().includes(e.value.toLowerCase())},Cell:function(e){return r.a.createElement("div",{style:{textAlign:"center"}},e.value)}},{Header:"Details",accessor:"properties.id",filterable:!1,Cell:function(e){return r.a.createElement(X.a,{onClick:function(){return function(e){E(e.original.iaga),u(!0)}(e)}},"view")}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{data:h,className:"-striped -highlight",columns:y,filterable:!0,sortable:!0,resizable:!0,filtered:[{id:"year",value:v}],defaultPageSize:10}),r.a.createElement(D,{show:o,onHide:function(){return u(!1)},iaga:d}))};Q.defaultProps={setSelectedObservatories:function(e){console.log(e)}};var ee=Q,te=function(){var e=Object(n.useState)([]),t=Object(c.a)(e,2),a=t[0],l=t[1];return r.a.createElement($.Consumer,null,function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{sm:4},r.a.createElement(ee,{definitives:e,setSelectedObservatories:l})),r.a.createElement(A.a,{sm:8},r.a.createElement(K,{observatories:a})))})},ae=function(){var e=S("https://geomag.bgs.ac.uk/im_mdata/imag_reports/contacts/?format=json"),t=Object(c.a)(e,1)[0],a=S("https://geomag.bgs.ac.uk/im_mdata/imag_reports/definitive/?format=json"),n=Object(c.a)(a,1)[0],l=S("https://geomag.bgs.ac.uk/im_mdata/imag_reports/institutes/?format=json"),i=Object(c.a)(l,1)[0],f=S("https://geomag.bgs.ac.uk/im_mdata/imag_reports/intermagnet/?format=json"),v=Object(c.a)(f,1)[0];return r.a.createElement(o.BrowserRouter,{basename:"/intermagnet-metadata-app"},r.a.createElement(j,{contactsState:t,definitiveState:n,institutesState:i,intermagnetState:v}),r.a.createElement(m.a,{bg:"primary",variant:"dark",expand:"lg"},r.a.createElement(m.a.Brand,{href:"https://intermagnet.github.io/"},"INTERMAGNET"),r.a.createElement(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(m.a.Collapse,null,r.a.createElement(d.a,{className:"mr-auto"},r.a.createElement(s.LinkContainer,{to:"/map"},r.a.createElement(d.a.Link,null,"Map of Observatories")),r.a.createElement(s.LinkContainer,{to:"/list"},r.a.createElement(d.a.Link,null,"List of Observatories")),r.a.createElement(s.LinkContainer,{to:"/definitives"},r.a.createElement(d.a.Link,null,"Definitive Data Catologue"))))),r.a.createElement(E.a,{fluid:!0,className:"main-content"},r.a.createElement(g.a,null,r.a.createElement(F.Provider,{value:v.data},r.a.createElement(T.Provider,{value:i.data},r.a.createElement(G.Provider,{value:t.data},r.a.createElement($.Provider,{value:n.data},r.a.createElement(u.d,{exact:!0,path:"/",component:Z}),r.a.createElement(u.d,{path:"/map",component:q}),r.a.createElement(u.d,{path:"/list",component:Z}),r.a.createElement(u.d,{path:"/definitives",component:te}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},88:function(e,t,a){e.exports=a(142)},93:function(e,t,a){},94:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.b45e6f79.chunk.js.map